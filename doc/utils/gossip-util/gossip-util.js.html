<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: gossip-util.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: gossip-util.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/**
* @module lib/utils 
* @const gossipUtil
* @desc This object contains a set of functions that are used by the different implementations of the 
* gossip protocols.
* @author Raziel Carvajal Gomez &lt;raziel.carvajal-gomez@inria.fr>*/
(function(exports){ 
  var gossipUtil = {
    /**
    * @method newItem
    * @desc Returns an object its age (timestamp) and its data.
    * @param {Integer} age
    * @param {Object} data*/
    newItem: function(age, data){
      return { age: age, data: data };
    },
    // TODO to finish with the documentation of this file...
    getRandomSubDict: function(n, src){
      if( n &lt;= 0 || Object.keys(src).length === 0 )
        return {};
      if( n >= Object.keys(src).length )
        return src;
      else {
        var tmpDict = {}, result = {}, key, tmpAr, i;
        for( key in src )
          tmpDict[key] = 1;
        i = 0;
        do{
          tmpAr = Object.keys(tmpDict);
          key = tmpAr[ Math.floor(Math.random() * tmpAr.length) ];
          result[key] = src[key];
          delete tmpDict[key];
          i += 1;
        }while( i != n );
        return result;
      }
    },
    getOldestKey: function(dictio){
      var keys = Object.keys(dictio);
      if( keys.length === 0 ){
        console.log('ERROR: Empty dictionary');
        return null;
      }
      var max = dictio[ keys[0] ].age;
      var maxIndx = keys[0];
      var i = 1;
      while( i &lt; keys.length ){
        if( dictio[ keys[i] ].age > max ){
          max = dictio[ keys[i] ].age;
          maxIndx = keys[i];
        }
        i += 1;
      }
      return maxIndx;
    },
    // Get a random key from a dictionary
    getRandomKey: function(dict){
      var key = null; var keys = Object.keys(dict);
      var dicSize = keys.length;
      if( dicSize === 0 )
        console.log('ERROR: no way to return a key from an empty dictionary');
      else{
        var rNum;
        if( dicSize === 1 )
          rNum = 0;
        else
          rNum = Math.floor(Math.random() * dicSize);
        key = keys[rNum];
      }
      return key;
    },
    removeRandomly: function(n, dic){
      if( n === 0 )
        return;
      else{
        var tmpDic = {}, tmpAr, key;
        for( key in dic )
          tmpDic[key] = 1;
        for( var i = 0; i &lt; n; i += 1 ){
          tmpAr = Object.keys(tmpDic);
          key = tmpAr[ Math.floor(Math.random() * tmpAr.length) ];
          delete tmpDic[key]; delete dic[key];
        }
      }
    },
    mergeViews: function(v1, v2){
      var key, result = {};
      for( key in v1 )
        result[key] = v1[key];
      for( key in v2 ){
        if( key in result ){
          if( 'data' in v2[key] && 'data' in result[key] ){
            if( v2[key].age &lt; result[key].age )
              result[key] = v2[key];
          } else{
            if( 'data' in v2[key] )
              result[key] = v2[key];
          }
        }else
          result[key] = v2[key];
      }
      return result;
    },
    setData: function(dic, key, d){
      if( key in dic )
        dic[key].data = d;
    },
    extendProperties: function(dst, src){
      var keys = Object.keys(src);
      for( var i = 0; i &lt; keys.length; i++ ){
        if( !dst.hasOwnProperty(keys[i]) )
          dst[ keys[i] ] = src[ keys[i] ];
      }
    }
  };

  exports.gossipUtil = gossipUtil;

})(this);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Global</h3><ul><li><a href="global.html#gossipUtil">gossipUtil</a></li><li><a href="global.html#newItem">newItem</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Tue Apr 08 2014 11:00:44 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
